<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Vectorisation with Deep Learning Project: src.training Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Vectorisation with Deep Learning Project
   </div>
   <div id="projectbrief">A Python project for generating line drawings and training Neural Network models for line vectorization.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesrc.html">src</a></li><li class="navelem"><a class="el" href="namespacesrc_1_1training.html">training</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">src.training Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae0c284e44ed6b90876e64672c6566851" id="r_ae0c284e44ed6b90876e64672c6566851"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0c284e44ed6b90876e64672c6566851">compile_model</a> (model, learning_rate=1e-4)</td></tr>
<tr class="separator:ae0c284e44ed6b90876e64672c6566851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab730b0abad7aebde140c6a1cddb9164e" id="r_ab730b0abad7aebde140c6a1cddb9164e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab730b0abad7aebde140c6a1cddb9164e">get_callbacks</a> (model_checkpoint_path='models/unet_best_model.keras')</td></tr>
<tr class="separator:ab730b0abad7aebde140c6a1cddb9164e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b6879a7c53233c9f0349fbec3e16d53" id="r_a6b6879a7c53233c9f0349fbec3e16d53"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b6879a7c53233c9f0349fbec3e16d53">train_model</a> (model, train_gen, val_gen, X_train, X_val, batch_size=16, epochs=100)</td></tr>
<tr class="separator:a6b6879a7c53233c9f0349fbec3e16d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">@file training.py
@brief Module for compiling and training the U-Net model.

This module provides functions to compile the U-Net model, set up callbacks,
and train the model using the provided data generators.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ae0c284e44ed6b90876e64672c6566851" name="ae0c284e44ed6b90876e64672c6566851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0c284e44ed6b90876e64672c6566851">&#9670;&#160;</a></span>compile_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.training.compile_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1e-4</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">@brief Compiles the U-Net model with specified optimizer and loss function.

This function configures the model for training by setting the optimizer, loss,
and evaluation metrics.

@param model (Model): Keras model to compile.
@param learning_rate (float, optional): Learning rate for the optimizer. Default is 1e-4.

@return Model: Compiled Keras model.
</pre> 
<p class="definition">Definition at line <a class="el" href="training_8py_source.html#l00012">12</a> of file <a class="el" href="training_8py_source.html">training.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   12</span><span class="keyword">def </span>compile_model(model, learning_rate=1e-4):</div>
<div class="line"><span class="lineno">   13</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   14</span><span class="stringliteral">    @brief Compiles the U-Net model with specified optimizer and loss function.</span></div>
<div class="line"><span class="lineno">   15</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   16</span><span class="stringliteral">    This function configures the model for training by setting the optimizer, loss,</span></div>
<div class="line"><span class="lineno">   17</span><span class="stringliteral">    and evaluation metrics.</span></div>
<div class="line"><span class="lineno">   18</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">    @param model (Model): Keras model to compile.</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral">    @param learning_rate (float, optional): Learning rate for the optimizer. Default is 1e-4.</span></div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">    @return Model: Compiled Keras model.</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   24</span>    model.compile(</div>
<div class="line"><span class="lineno">   25</span>        optimizer=Adam(learning_rate=learning_rate),</div>
<div class="line"><span class="lineno">   26</span>        loss=<span class="stringliteral">&#39;binary_crossentropy&#39;</span>,</div>
<div class="line"><span class="lineno">   27</span>        metrics=[<span class="stringliteral">&#39;accuracy&#39;</span>]</div>
<div class="line"><span class="lineno">   28</span>    )</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">return</span> model</div>
<div class="line"><span class="lineno">   30</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab730b0abad7aebde140c6a1cddb9164e" name="ab730b0abad7aebde140c6a1cddb9164e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab730b0abad7aebde140c6a1cddb9164e">&#9670;&#160;</a></span>get_callbacks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.training.get_callbacks </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_checkpoint_path</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'models/unet_best_model.keras'</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">@brief Creates callbacks for training.

This function sets up EarlyStopping to halt training when validation loss stops improving
and ModelCheckpoint to save the best model during training.

@param model_checkpoint_path (str, optional): Path to save the best model. Default is 'unet_best_model.keras'.

@return list: List of callback instances.
</pre> 
<p class="definition">Definition at line <a class="el" href="training_8py_source.html#l00031">31</a> of file <a class="el" href="training_8py_source.html">training.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span><span class="keyword">def </span>get_callbacks(model_checkpoint_path=&#39;models/unet_best_model.keras&#39;):</div>
<div class="line"><span class="lineno">   32</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    @brief Creates callbacks for training.</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">    This function sets up EarlyStopping to halt training when validation loss stops improving</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    and ModelCheckpoint to save the best model during training.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    @param model_checkpoint_path (str, optional): Path to save the best model. Default is &#39;unet_best_model.keras&#39;.</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    @return list: List of callback instances.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   42</span>    earlystopper = EarlyStopping(</div>
<div class="line"><span class="lineno">   43</span>        monitor=<span class="stringliteral">&#39;val_loss&#39;</span>,</div>
<div class="line"><span class="lineno">   44</span>        patience=10,</div>
<div class="line"><span class="lineno">   45</span>        verbose=1,</div>
<div class="line"><span class="lineno">   46</span>        restore_best_weights=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">   47</span>    )</div>
<div class="line"><span class="lineno">   48</span>    checkpointer = ModelCheckpoint(</div>
<div class="line"><span class="lineno">   49</span>        model_checkpoint_path,</div>
<div class="line"><span class="lineno">   50</span>        monitor=<span class="stringliteral">&#39;val_loss&#39;</span>,</div>
<div class="line"><span class="lineno">   51</span>        verbose=1,</div>
<div class="line"><span class="lineno">   52</span>        save_best_only=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">   53</span>    )</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">return</span> [earlystopper, checkpointer]</div>
<div class="line"><span class="lineno">   55</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b6879a7c53233c9f0349fbec3e16d53" name="a6b6879a7c53233c9f0349fbec3e16d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b6879a7c53233c9f0349fbec3e16d53">&#9670;&#160;</a></span>train_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">src.training.train_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_gen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>val_gen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X_train</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X_val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">16</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epochs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">@brief Trains the U-Net model using the provided generators.

This function fits the model on the training data using data generators for augmentation,
validates on the validation data, and applies callbacks for early stopping and model checkpointing.

@param model (Model): Compiled Keras model to train.
@param train_gen (generator): Training data generator.
@param val_gen (generator): Validation data generator.
@param X_train (numpy.ndarray): Number of training samples.
@param X_val (numpy.ndarray): Number of validation samples.
@param batch_size (int, optional): Number of samples per batch. Default is 16.
@param epochs (int, optional): Maximum number of training epochs. Default is 100.

@return History: Keras History object containing training history.
</pre> 
<p class="definition">Definition at line <a class="el" href="training_8py_source.html#l00056">56</a> of file <a class="el" href="training_8py_source.html">training.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span><span class="keyword">def </span>train_model(model, train_gen, val_gen, X_train, X_val, batch_size=16, epochs=100):</div>
<div class="line"><span class="lineno">   57</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral">    @brief Trains the U-Net model using the provided generators.</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">    This function fits the model on the training data using data generators for augmentation,</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    validates on the validation data, and applies callbacks for early stopping and model checkpointing.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">    @param model (Model): Compiled Keras model to train.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    @param train_gen (generator): Training data generator.</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">    @param val_gen (generator): Validation data generator.</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    @param X_train (numpy.ndarray): Number of training samples.</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    @param X_val (numpy.ndarray): Number of validation samples.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    @param batch_size (int, optional): Number of samples per batch. Default is 16.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    @param epochs (int, optional): Maximum number of training epochs. Default is 100.</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    @return History: Keras History object containing training history.</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   73</span>    callbacks = get_callbacks()</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    history = model.fit(</div>
<div class="line"><span class="lineno">   76</span>        train_gen,</div>
<div class="line"><span class="lineno">   77</span>        steps_per_epoch=len(X_train) // batch_size,</div>
<div class="line"><span class="lineno">   78</span>        epochs=epochs,</div>
<div class="line"><span class="lineno">   79</span>        validation_data=val_gen,</div>
<div class="line"><span class="lineno">   80</span>        validation_steps=len(X_val) // batch_size,</div>
<div class="line"><span class="lineno">   81</span>        callbacks=callbacks</div>
<div class="line"><span class="lineno">   82</span>    )</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">return</span> history</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesrc_1_1training_a6b6879a7c53233c9f0349fbec3e16d53_cgraph.png" border="0" usemap="#anamespacesrc_1_1training_a6b6879a7c53233c9f0349fbec3e16d53_cgraph" alt=""/></div>
<map name="anamespacesrc_1_1training_a6b6879a7c53233c9f0349fbec3e16d53_cgraph" id="anamespacesrc_1_1training_a6b6879a7c53233c9f0349fbec3e16d53_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,120,46"/>
<area shape="rect" href="namespacesrc_1_1training.html#ab730b0abad7aebde140c6a1cddb9164e" title=" " alt="" coords="168,13,337,38"/>
<area shape="poly" title=" " alt="" coords="120,23,152,23,152,28,120,28"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
